<html>
    <head>
        <title>Fix your broken TBR save code</title>
        <script type="text/javascript">
const lookup = ['9', '8', '7', '6', '5', '4', '3', '2', '1', '0', 'Z', 'Y', 'X', 'W', 'V', 'U', 'T', 'S', 'R', 'Q', 'P', 'O', 'N', 'M', 'L', 'K', 'J', 'I', 'H', 'G', 'F', 'E', 'D', 'C', 'B', 'A', 'z', 'y', 'x', 'w', 'v', 'u', 't', 's', 'r', 'q', 'p', 'o', 'n', 'm', 'l', 'k', 'j', 'i', 'h', 'g', 'f', 'e', 'd', 'c', 'b', 'a'];
function inc(c, n) {
    return lookup[(lookup.indexOf(c) + n) % 62]
}
function modifyAt(str, index, n) {
    if (index >= str.length) return str;
    return str.substr(0, index) + inc(str[index], n) + str.substr(index + 1);
}
function fixMyCode() {
    var code = document.getElementById("code").value;
    var old_name = document.getElementById("oldname").value;
    var new_name = document.getElementById("newname").value;
    if (!new_name.startsWith(old_name)) {
        alert("You can't use somebody else's name lmao");
        return
    }
    var length_diff = new_name.length - old_name.length
    document.getElementById("output").innerHTML = modifyAt(modifyAt(code, 40, length_diff), 15, length_diff);
}
        </script>
    </head>
    <body>
        <div>
            This tool is for updating pre-1.39 save codes that were saved with old battle.net account names, from before WC3 Reforged was released; it will let you migrate from "Santiclause" to "Santiclause#1303".
        </div>
        <div>
            If you want to update a pre-1.39 code to 1.39+, <i>this is not the tool to use</i>. You need to <a href="https://www.hiveworkshop.com/attachments/theblackroadrpgv1-39a2-w3x.387535/">download v1.39a2</a> (the last
            version to support pre-1.39 style save codes), load your pre-1.39 code inside that map, then save it to generate a 1.39+ style code.
        </div>
        <form id="inputs"  action="javascript:fixMyCode();">
            <div>
                <label for="code">Your save code (e.g.: -load ABCDE-FGHJI-KLMNO-PQRST-UVWXY-Z0123-45678-9abcd)</label>
                <input type="text" id="code" required minlength=53 maxlength=53 size=53>
            </div>
            <div>
                <label for="oldname">Your old battle.net tag (as WC3 saw it) (e.g. Santiclause)</label>
                <input type="text" id="oldname" required>
            </div>
            <div>
                <label for="newname">Your new battle.net tag (as WC3 now sees it, i.e your <i>actual</i> battle.net tag) (e.g. Santiclause#1303)</label>
                <input type="text" id="newname" required>
            </div>
            <input type="submit" value="Fix my code">
        </form>
        <div> output: </div>
        <div id="output">
        </div>
    </body>
</html>
